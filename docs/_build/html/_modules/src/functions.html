

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>src.functions &mdash; Coral model 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Coral model
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Coral model</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>src.functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for src.functions</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">error</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<div class="viewcode-block" id="scenario_1"><a class="viewcode-back" href="../../src.html#src.functions.scenario_1">[docs]</a><span class="k">def</span> <span class="nf">scenario_1</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_end</span><span class="p">,</span> <span class="n">rugosity_factor</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">growth_rate</span><span class="p">,</span> <span class="n">ruosity_I</span><span class="p">,</span> <span class="n">slope_max</span><span class="p">,</span> <span class="n">slope_av</span><span class="p">,</span> <span class="n">slope_min</span><span class="p">,</span> <span class="n">age_cover</span><span class="p">,</span> <span class="n">max_size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function calculates coral cover growth rate in no-stress condition (scenario 1). </span>

<span class="sd">    :param year_start: Starting year for the coral growth calculation</span>
<span class="sd">    :type year_start: int</span>
<span class="sd">    :param year_end: Final year</span>
<span class="sd">    :type year_end: int</span>
<span class="sd">    :param rugosity_factor: Rugosity factor for branching, plate and massive coral morphologies</span>
<span class="sd">    :type rugosity_factor: list of floats</span>
<span class="sd">    :param D: Diameter size distribution for branching, plate and massive coral morphologies</span>
<span class="sd">    :type D: 3D list of floats</span>
<span class="sd">    :param H: Height size distribution of coral colonies </span>
<span class="sd">    :type H: list of floats</span>
<span class="sd">    :param growth_rate: Coral growth rate for branching, plate and massive coral morphologies</span>
<span class="sd">    :type growth_rate: list of floats</span>
<span class="sd">    :param ruosity_I: Initial rugosity of colony</span>
<span class="sd">    :type ruosity_I: float</span>
<span class="sd">    :param slope_max: Maximum slope for calculating rugosity from total cover if ratio &gt; 1.0:</span>
<span class="sd">    :type slope_max: float</span>
<span class="sd">    :param slope_av: Average slope for calculating rugosity from total cover  if 0.1 &lt; ratio &lt; 1.0:</span>
<span class="sd">    :type slope_av: float</span>
<span class="sd">    :param slope_min: Minimum slope for calculating rugosity from total cover  if ratio &lt; 0.1:</span>
<span class="sd">    :type slope_min: float</span>
<span class="sd">    :param age_cover: % age cover</span>
<span class="sd">    :type age_cover: float</span>
<span class="sd">    :param max_size: Maximum diameter size for branching, plate and massive coral morphologies</span>
<span class="sd">    :type max_size: list of floats</span>
<span class="sd">    :return: A dictionary of all calculated new values between start_year and end_year</span>
<span class="sd">    :rtype: dict</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">age_cover_b</span> <span class="o">=</span> <span class="n">age_cover</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">age_cover_p</span> <span class="o">=</span> <span class="n">age_cover</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">age_cover_m</span> <span class="o">=</span> <span class="n">age_cover</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">D_b</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">D_p</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">D_m</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">ratio</span> <span class="o">=</span> <span class="n">age_cover_b</span><span class="o">/</span><span class="n">age_cover_p</span><span class="o">/</span><span class="n">age_cover_m</span>
    <span class="n">total_cover</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">age_cover</span><span class="p">)</span>
    
    <span class="n">Data</span> <span class="o">=</span> <span class="n">initialize_data</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">ruosity_I</span><span class="p">,</span> <span class="n">total_cover</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">age_cover</span><span class="p">)</span>
    
    <span class="c1">#claculating surface area</span>
    <span class="c1"># SA_b = calc_SA(D_b)</span>
    <span class="c1"># SA_p = calc_SA(D_p)</span>
    <span class="c1"># SA_m = calc_SA(D_m)</span>
    
    <span class="n">SA_b</span> <span class="o">=</span> <span class="n">calc_SA</span><span class="p">(</span><span class="n">get_average</span><span class="p">(</span><span class="n">D_b</span><span class="p">))</span>
    <span class="n">SA_p</span> <span class="o">=</span> <span class="n">calc_SA</span><span class="p">(</span><span class="n">get_average</span><span class="p">(</span><span class="n">D_p</span><span class="p">))</span>
    <span class="n">SA_m</span> <span class="o">=</span> <span class="n">calc_SA</span><span class="p">(</span><span class="n">get_average</span><span class="p">(</span><span class="n">D_m</span><span class="p">))</span>


    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;SA_b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SA_b</span><span class="p">]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;SA_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SA_p</span><span class="p">]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;SA_m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">SA_m</span><span class="p">]</span>



    <span class="n">year</span> <span class="o">=</span> <span class="n">year_start</span>
    <span class="c1">#D_n = D</span>
    <span class="c1">#H_n = H</span>
    <span class="k">while</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="n">year_end</span><span class="p">:</span>
        
        <span class="c1">#claculate new Diameter and new surface area</span>
        <span class="c1"># D_n[0] = D[0] + (2.0 * growth_rate[0])</span>
        <span class="c1"># D_n[1] = D[1] + growth_rate[1]</span>
        <span class="c1"># D_n[2] = D[2] + (2.0 * growth_rate[2])</span>

        <span class="c1">#for i in range(3):</span>
        <span class="n">D_n_b</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">D_b</span><span class="p">:</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">2.0</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">new_value</span> <span class="o">=</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">D_n_b</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">new_value</span><span class="p">,</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="n">D_n_p</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">D_p</span><span class="p">:</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">new_value</span> <span class="o">=</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">D_n_p</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">new_value</span><span class="p">,</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="n">D_n_m</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">D_m</span><span class="p">:</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">growth_rate</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">2.0</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">new_value</span> <span class="o">=</span> <span class="n">max_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">D_n_m</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">new_value</span><span class="p">,</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>




        <span class="c1">#SA_n = (8.0 * np.pi / 3.0) * (D_n ** 2.0 / (16.0 * H)) ** 2.0 * ((16.0 * (H/D_n)**2.0 + 1.0) ** 1.5 - 1.0)</span>
        <span class="c1">#claculate age coral cover %</span>
        <span class="n">SA_n_b</span> <span class="o">=</span> <span class="n">calc_SA</span><span class="p">(</span><span class="n">D_n_b</span><span class="p">)</span>
        <span class="n">SA_n_p</span> <span class="o">=</span> <span class="n">calc_SA</span><span class="p">(</span><span class="n">D_n_p</span><span class="p">)</span>
        <span class="n">SA_n_m</span> <span class="o">=</span> <span class="n">calc_SA</span><span class="p">(</span><span class="n">D_n_m</span><span class="p">)</span>

        
        
        <span class="n">age_cover_change_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">SA_n_b</span><span class="o">-</span><span class="n">SA_b</span><span class="p">)</span><span class="o">/</span><span class="n">SA_b</span> <span class="o">*</span> <span class="mf">100.0</span>
        <span class="n">age_cover_change_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">SA_n_p</span><span class="o">-</span><span class="n">SA_p</span><span class="p">)</span><span class="o">/</span><span class="n">SA_p</span> <span class="o">*</span> <span class="mf">100.0</span>
        <span class="n">age_cover_change_m</span> <span class="o">=</span> <span class="p">(</span><span class="n">SA_n_m</span><span class="o">-</span><span class="n">SA_m</span><span class="p">)</span><span class="o">/</span><span class="n">SA_m</span> <span class="o">*</span> <span class="mf">100.0</span>

        <span class="n">age_cover_n_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">age_cover_b</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">+</span> <span class="n">age_cover_change_b</span><span class="p">)</span>
        <span class="n">age_cover_n_p</span> <span class="o">=</span> <span class="p">(</span><span class="n">age_cover_p</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">+</span> <span class="n">age_cover_change_p</span><span class="p">)</span>
        <span class="n">age_cover_n_m</span> <span class="o">=</span> <span class="p">(</span><span class="n">age_cover_m</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">+</span> <span class="n">age_cover_change_m</span><span class="p">)</span>


        <span class="c1">#age_cover_new = (age_cover / 100.0) *(100.0 + age_cover_change)</span>
        <span class="n">total_cover_n</span> <span class="o">=</span> <span class="n">age_cover_n_b</span> <span class="o">+</span> <span class="n">age_cover_n_p</span> <span class="o">+</span> <span class="n">age_cover_n_m</span>

        <span class="c1">#Ratio</span>
        <span class="n">ratio_n</span> <span class="o">=</span>  <span class="n">age_cover_n_b</span> <span class="o">/</span> <span class="n">age_cover_n_p</span> <span class="o">/</span> <span class="n">age_cover_n_m</span>

        <span class="k">if</span> <span class="n">ratio_n</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">slope_max</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">ratio_n</span> <span class="o">&lt;=</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">ratio_n</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">):</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">slope_av</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#ratio&lt;0.1</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">slope_min</span>

        <span class="n">ruosity_I_n</span> <span class="o">=</span> <span class="n">ruosity_I</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">total_cover_n</span> <span class="o">-</span> <span class="n">total_cover</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;RI&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ruosity_I_n</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ratio_n</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;TC&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_cover_n</span><span class="p">)</span>
        <span class="c1">#Data[&quot;Diam_b&quot;].append(np.average(D_n))</span>

        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;age_cover_b&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_cover_n_b</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;age_cover_p&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_cover_n_p</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;age_cover_m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_cover_n_m</span><span class="p">)</span>

        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Diam_b&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_distribution</span><span class="p">(</span><span class="n">D_n_b</span><span class="p">))</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Diam_p&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_distribution</span><span class="p">(</span><span class="n">D_n_p</span><span class="p">))</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Diam_m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_distribution</span><span class="p">(</span><span class="n">D_n_m</span><span class="p">))</span>

        <span class="c1"># Data[&quot;Height_b&quot;].append(H_n[0])</span>
        <span class="c1"># Data[&quot;Height_p&quot;].append(H_n[1])</span>
        <span class="c1"># Data[&quot;Height_m&quot;].append(H_n[2])</span>

        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;SA_b&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SA_n_b</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;SA_p&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SA_n_p</span><span class="p">)</span>
        <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;SA_m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SA_n_m</span><span class="p">)</span>
        
        
        <span class="c1">#Data[&quot;Height&quot;].append(np.average(H_n))</span>

        <span class="c1">#get ready for next iteration</span>
        <span class="n">D_b</span> <span class="o">=</span> <span class="n">D_n_b</span>
        <span class="n">D_p</span> <span class="o">=</span> <span class="n">D_n_p</span>
        <span class="n">D_m</span> <span class="o">=</span> <span class="n">D_n_m</span>

        <span class="c1">#H = H_n</span>
        <span class="n">age_cover_b</span> <span class="o">=</span> <span class="n">age_cover_n_b</span>
        <span class="n">age_cover_p</span> <span class="o">=</span> <span class="n">age_cover_n_p</span>
        <span class="n">age_cover_m</span> <span class="o">=</span> <span class="n">age_cover_n_m</span>

        <span class="n">SA_b</span> <span class="o">=</span> <span class="n">SA_n_b</span>
        <span class="n">SA_p</span> <span class="o">=</span> <span class="n">SA_n_p</span>
        <span class="n">SA_m</span> <span class="o">=</span> <span class="n">SA_n_m</span>

        <span class="n">total_cover</span> <span class="o">=</span> <span class="n">total_cover_n</span>
        <span class="n">ruosity_I</span> <span class="o">=</span> <span class="n">ruosity_I_n</span>

    
    <span class="k">return</span> <span class="n">Data</span></div>

<div class="viewcode-block" id="get_growth_rates"><a class="viewcode-back" href="../../src.html#src.functions.get_growth_rates">[docs]</a><span class="k">def</span> <span class="nf">get_growth_rates</span><span class="p">(</span><span class="n">default_rates</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function helps users select appropriate coral growth rates based on previouse data. It uses default values if </span>
<span class="sd">    no data is available.</span>

<span class="sd">    :param default_rates: Default growth rate values</span>
<span class="sd">    :type default_rates: list of floats</span>
<span class="sd">    :return: growth rate values </span>
<span class="sd">    :rtype: list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">average_rates</span> <span class="o">=</span> <span class="n">default_rates</span>
    <span class="n">G_rate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;Growth_rates.xlsx&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">G_rate</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;Unnamed&quot;</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
            <span class="n">G_rate</span> <span class="o">=</span> <span class="n">G_rate</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
    
    <span class="c1">#------------------------------------------------------</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Region1&quot;</span><span class="p">,</span> <span class="s2">&quot;Region2&quot;</span><span class="p">,</span> <span class="s2">&quot;Country&quot;</span><span class="p">,</span> <span class="s2">&quot;study_date&quot;</span><span class="p">,</span> <span class="s2">&quot;Period_category&quot;</span><span class="p">,</span> <span class="s2">&quot;Depth_category&quot;</span><span class="p">,</span> <span class="s2">&quot;Species&quot;</span> <span class="p">,</span> <span class="s2">&quot;Genus&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">:</span>
        <span class="n">unique_value</span> <span class="o">=</span> <span class="n">G_rate</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please select a number for &quot;</span><span class="o">+</span> <span class="n">column</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_value</span><span class="p">)):</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;[</span><span class="si">{}</span><span class="s2">] : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">unique_value</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[-1] : Pass this filter&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[-2] : Get growth rate and continue&quot;</span><span class="p">)</span>
        
        <span class="n">ans</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">ans</span><span class="p">:</span> 
            <span class="n">R1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;your answer? &quot;</span><span class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">R1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_value</span><span class="p">))</span> <span class="ow">or</span> <span class="n">R1</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Answer not valid! please try again&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">R1</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">R1</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">G_rate</span> <span class="o">=</span> <span class="n">G_rate</span><span class="p">[</span><span class="n">G_rate</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">unique_value</span><span class="p">[</span><span class="n">R1</span><span class="p">]]</span>
            <span class="n">Final</span> <span class="o">=</span> <span class="n">G_rate</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Morpholgy1&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">av_growth_rate</span>
            
            <span class="k">if</span> <span class="s2">&quot;Branching&quot;</span> <span class="ow">in</span> <span class="n">Final</span><span class="p">:</span> 
                <span class="n">average_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Final</span><span class="p">[</span><span class="s2">&quot;Branching&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth_rate_Branching:&quot;</span><span class="p">,</span> <span class="n">average_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">average_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth_rate_Branching:&quot;</span><span class="p">,</span> <span class="n">average_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;(default value)&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;Plate&quot;</span> <span class="ow">in</span> <span class="n">Final</span><span class="p">:</span> 
                <span class="n">average_rates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Final</span><span class="p">[</span><span class="s2">&quot;Plate&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth_rate_Plate:&quot;</span><span class="p">,</span> <span class="n">average_rates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">average_rates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_rates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth_rate_Plate:&quot;</span><span class="p">,</span> <span class="n">average_rates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;(default value)&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s2">&quot;Massive&quot;</span> <span class="ow">in</span> <span class="n">Final</span><span class="p">:</span> 
                <span class="n">average_rates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Final</span><span class="p">[</span><span class="s2">&quot;Massive&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth_rate_Massive:&quot;</span><span class="p">,</span> <span class="n">average_rates</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">average_rates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_rates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth_rate_Massive:&quot;</span><span class="p">,</span> <span class="n">average_rates</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;(default value)&quot;</span><span class="p">)</span>
        
        <span class="n">num_values</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G_rate</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_values</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth rate average based on </span><span class="si">{}</span><span class="s2"> values&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_values</span><span class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Growth rate average based on </span><span class="si">{}</span><span class="s2"> values&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_values</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No more refinement is possible!&quot;</span><span class="p">)</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>
            <span class="k">break</span>
    
    <span class="k">return</span> <span class="n">average_rates</span></div>

<div class="viewcode-block" id="get_distribution"><a class="viewcode-back" href="../../src.html#src.functions.get_distribution">[docs]</a><span class="k">def</span> <span class="nf">get_distribution</span><span class="p">(</span><span class="n">Initial_D</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function returns a full distribution range (ready to be displayed as histograms) based on the distribution list provided/ calulated by users</span>

<span class="sd">    :param Initial_D: list of size distribution as size and percentages </span>
<span class="sd">    :type Initial_D: 2D list</span>
<span class="sd">    :return: full distribution range</span>
<span class="sd">    :rtype: dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)],</span>
            <span class="s2">&quot;perc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)]</span>
        <span class="p">}</span>
                    <span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Initial_D</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="c1">#get the index </span>
        <span class="n">SD</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span>  <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">SD</span></div>

    
<div class="viewcode-block" id="check_distribution"><a class="viewcode-back" href="../../src.html#src.functions.check_distribution">[docs]</a><span class="k">def</span> <span class="nf">check_distribution</span><span class="p">(</span><span class="n">Initial_D</span><span class="p">):</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Initial_D</span><span class="p">]</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total</span><span class="o">==</span><span class="mi">100</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="calc_height"><a class="viewcode-back" href="../../src.html#src.functions.calc_height">[docs]</a><span class="k">def</span> <span class="nf">calc_height</span><span class="p">(</span><span class="n">diam_D</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function calculates height based on morphology and diameter of corals</span>

<span class="sd">    :param diam_D: coral diameter</span>
<span class="sd">    :type diam_D: float</span>
<span class="sd">    :param type: coral morphology type</span>
<span class="sd">    :type type: str</span>
<span class="sd">    :return: list of heights</span>
<span class="sd">    :rtype: list </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">height_D</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">diam_D</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> 
            <span class="n">value</span> <span class="o">=</span> <span class="mf">0.3039</span> <span class="o">*</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">3.5049</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;p&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mf">0.1086</span> <span class="o">*</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">4.3986</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;m&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mf">0.5706</span> <span class="o">*</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">6.4725</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="s2">&quot;invalide type in calc_height function&quot;</span><span class="p">)</span>
        

        <span class="n">height_D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">height_D</span></div>

<div class="viewcode-block" id="calc_SA"><a class="viewcode-back" href="../../src.html#src.functions.calc_SA">[docs]</a><span class="k">def</span> <span class="nf">calc_SA</span><span class="p">(</span><span class="n">diam_D</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function claculates the surface area from diameters</span>

<span class="sd">    :param diam_D: Diameter distribution or list</span>
<span class="sd">    :type diam_D: 2D list or float</span>
<span class="sd">    :return: surface area </span>
<span class="sd">    :rtype: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">diam_D</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span> <span class="c1"># check if the diameter is distribution</span>
        <span class="n">SA_D</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">diam_D</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.28</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.67</span> <span class="o">*</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> <span class="mf">3.14</span>
            <span class="n">SA_D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

        <span class="n">SA_av</span> <span class="o">=</span> <span class="n">get_average</span><span class="p">(</span><span class="n">SA_D</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SA_av</span> <span class="o">=</span> <span class="p">(</span><span class="n">diam_D</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.28</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.67</span> <span class="o">*</span> <span class="n">diam_D</span><span class="p">))</span> <span class="o">*</span> <span class="mf">3.14</span>

    <span class="k">return</span> <span class="n">SA_av</span></div>

<div class="viewcode-block" id="get_average"><a class="viewcode-back" href="../../src.html#src.functions.get_average">[docs]</a><span class="k">def</span> <span class="nf">get_average</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function calculates the average value of a size distribution</span>

<span class="sd">    :param list: 2D list for representing a size distribution</span>
<span class="sd">    :type list: 2D list</span>
<span class="sd">    :return: average value</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">average</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">average</span> <span class="o">+=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">100.0</span>
    
    <span class="k">return</span> <span class="n">average</span></div>

<div class="viewcode-block" id="initialize_data"><a class="viewcode-back" href="../../src.html#src.functions.initialize_data">[docs]</a><span class="k">def</span> <span class="nf">initialize_data</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">ruosity_I</span><span class="p">,</span> <span class="n">total_cover</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">age_cover</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function initialize the data dictionary for saving the results</span>

<span class="sd">    :param year_start: starting year for coral growth </span>
<span class="sd">    :type year_start: int</span>
<span class="sd">    :param D: Initial diameter distribution</span>
<span class="sd">    :type D: 2D list</span>
<span class="sd">    :param ruosity_I: Initial rugosity</span>
<span class="sd">    :type ruosity_I: float</span>
<span class="sd">    :param total_cover: initial total coral cover</span>
<span class="sd">    :type total_cover: float</span>
<span class="sd">    :param ratio: cover ratio</span>
<span class="sd">    :type ratio: float</span>
<span class="sd">    :param age_cover: % age cover</span>
<span class="sd">    :type age_cover: float</span>
<span class="sd">    :return: data dictionary with initial values</span>
<span class="sd">    :rtype: dict</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Data</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;RI&quot;</span><span class="p">,</span> <span class="s2">&quot;Ratio&quot;</span><span class="p">,</span> <span class="s2">&quot;TC&quot;</span><span class="p">,</span> <span class="s2">&quot;age_cover_b&quot;</span><span class="p">,</span><span class="s2">&quot;age_cover_p&quot;</span><span class="p">,</span><span class="s2">&quot;age_cover_m&quot;</span><span class="p">,</span> <span class="s2">&quot;Diam_b&quot;</span><span class="p">,</span><span class="s2">&quot;Diam_p&quot;</span><span class="p">,</span><span class="s2">&quot;Diam_m&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;Height_b&quot;</span><span class="p">,</span><span class="s2">&quot;Height_p&quot;</span><span class="p">,</span><span class="s2">&quot;Height_m&quot;</span><span class="p">,</span> <span class="s2">&quot;SA_b&quot;</span><span class="p">,</span><span class="s2">&quot;SA_p&quot;</span><span class="p">,</span><span class="s2">&quot;SA_m&quot;</span> <span class="p">})</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">year_start</span><span class="p">]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;RI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ruosity_I</span><span class="p">]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Ratio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ratio</span><span class="p">]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;TC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">total_cover</span><span class="p">]</span>

    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;age_cover_b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">age_cover</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;age_cover_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">age_cover</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;age_cover_m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">age_cover</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Diam_b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_distribution</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Diam_p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_distribution</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Diam_m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_distribution</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>

    <span class="c1"># Data[&quot;Height_b&quot;] = [H[0]]</span>
    <span class="c1"># Data[&quot;Height_p&quot;] = [H[1]]</span>
    <span class="c1"># Data[&quot;Height_m&quot;] = [H[2]]</span>
    <span class="k">return</span> <span class="n">Data</span></div>

<div class="viewcode-block" id="get_cmap"><a class="viewcode-back" href="../../src.html#src.functions.get_cmap">[docs]</a><span class="k">def</span> <span class="nf">get_cmap</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function maps each index in 0, 1, ..., n-1 to a distinct </span>
<span class="sd">    RGB color; the keyword argument name must be a standard mpl colormap name</span>

<span class="sd">    :param n: index</span>
<span class="sd">    :type n: int</span>
<span class="sd">    :param name: defaults to &#39;hsv&#39;</span>
<span class="sd">    :type name: str, optional</span>
<span class="sd">    :return: list of color names</span>
<span class="sd">    :rtype: list </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="sd">&#39;&#39;&#39;.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></div>


</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Foad Farivar, Nicola Browne.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>